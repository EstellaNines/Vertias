using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using UnityEngine.EventSystems;
using TMPro; // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777TMPro171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777

public class MissionSection : MonoBehaviour, IPointerClickHandler
{
    [Header("171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777")]
    [SerializeField] private Image missionBarImage; // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Image171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777

    [Header("171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777")]
    [SerializeField] private TextMeshProUGUI missionNameText; // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777TMP171177117117771171177117117777171177117117771171177117117777
    [SerializeField] private Image missionTypeIcon; // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777

    [Header("171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777")]
    [SerializeField] private Sprite normalSprite; // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117779171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117770171177117117772
    [SerializeField] private Sprite confirmedSprite; // 171177117117770171177117117772171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117770171177117117776171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117770171177117117772

    [Header("171177117117770171177117117778171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777")]
    private bool isConfirmed = false; // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117779171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    private int missionIndex = -1;
    private MissionManager missionManager;

    // 171177117117771171177117117777171177117117771711771171177717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117777171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Image171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    private List<GameObject> clickableObjects = new List<GameObject>();

    private void Start()
    {
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117779171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        if (missionBarImage == null)
        {
            Debug.LogError("MissionSection: 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Image17117711711777171177017117711171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Inspector171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775Image171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777");
        }

        if (normalSprite == null)
        {
            Debug.LogError("MissionSection: 17117711711777017117711711777917117711711777017117711711777317117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777017117711711777017117711711777017117711711777217117711711777171177017117711171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Inspector171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775Sprite171177117117771171177117117777171177117117771171177117117777171177117117770171177117117776");
        }

        if (confirmedSprite == null)
        {
            Debug.LogError("MissionSection: 17117711711777017117711711777217117711711777117117711711777717117711711777017117711711777217117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777017117711711777017117711711777017117711711777217117711711777171177017117711171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Inspector171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775Sprite171177117117771171177117117777171177117117771171177117117777171177117117770171177117117776");
        }

        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        if (missionNameText == null)
        {
            Debug.LogWarning("MissionSection: 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777TMP17117711711777117117711711777717117711711777117117711711777717117711711777171177017117711171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Inspector171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775TextMeshProUGUI171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777");
        }

        if (missionTypeIcon == null)
        {
            Debug.LogWarning("MissionSection: 17117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777017117711711777017117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777171177017117711171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Inspector171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775Image171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777");
        }

        // 171177117117771171177117117777171177117117771171177117117777171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117770171177117117779171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117770171177117117772
        if (missionBarImage != null && normalSprite != null)
        {
            missionBarImage.sprite = normalSprite;
        }

        // 17117711711777117117711711777717117711711777017117711711777817117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        CollectClickableObjects();

        // 171177117117771171177117117777171177117117771171177117117777171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775
        InitializeMissionDisplay();
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775
    private void InitializeMissionDisplay()
    {
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777MissionManager1711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177717117711711777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        if (missionManager != null && missionIndex >= 0)
        {
            UpdateMissionDisplay();
        }
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    private void UpdateMissionDisplay()
    {
        if (missionManager == null || missionIndex < 0) return;

        // 171177117117771171177117117777171177117117771171177117117777MissionManager171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        MissionData missionData = missionManager.GetMissionData(missionIndex);
        if (missionData != null)
        {
            // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
            if (missionNameText != null)
            {
                missionNameText.text = missionData.name;
            }

            // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777
            if (missionTypeIcon != null && !string.IsNullOrEmpty(missionData.iconPath))
            {
                LoadAndSetIcon(missionData.iconPath);
            }
        }
        else
        {
            // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117779171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117775171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
            if (missionNameText != null)
            {
                missionNameText.text = $"171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777 {missionIndex + 1}";
            }

            if (missionTypeIcon != null)
            {
                missionTypeIcon.gameObject.SetActive(false);
            }
        }
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777
    private void LoadAndSetIcon(string iconPath)
    {
        if (missionTypeIcon == null || string.IsNullOrEmpty(iconPath))
        {
            return;
        }

        try
        {
            Sprite iconSprite = Resources.Load<Sprite>(iconPath);
            if (iconSprite != null)
            {
                missionTypeIcon.sprite = iconSprite;
                missionTypeIcon.gameObject.SetActive(true);
            }
            else
            {
                Debug.LogWarning($"MissionSection: 171177117117771171177117117777171177117117771171177117117779171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777: {iconPath}");
                missionTypeIcon.gameObject.SetActive(false);
            }
        }
        catch (System.Exception e)
        {
            Debug.LogError($"MissionSection: 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777: {e.Message}");
            missionTypeIcon.gameObject.SetActive(false);
        }
    }

    // 171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777Image171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    private void CollectClickableObjects()
    {
        clickableObjects.Clear();

        if (missionBarImage != null)
        {
            // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Image171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
            clickableObjects.Add(missionBarImage.gameObject);

            // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
            CollectChildObjects(missionBarImage.transform);
        }

        Debug.Log($"MissionSection: 171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777 {clickableObjects.Count} 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777");
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    private void CollectChildObjects(Transform parent)
    {
        for (int i = 0; i < parent.childCount; i++)
        {
            Transform child = parent.GetChild(i);
            clickableObjects.Add(child.gameObject);

            // 1711771171177711711771171177771711771171177711711771171177771711771171177717117711711777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
            if (child.childCount > 0)
            {
                CollectChildObjects(child);
            }
        }
    }

    // 171177117117770171177117117776171177117117771171177117117777171177117117771171177117117777IPointerClickHandler171177117117771171177117117777171177117117770171177117117773171177117117771171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777
    public void OnPointerClick(PointerEventData eventData)
    {
        // 17117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777017117711711777817117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777017117711711777917117711711777117117711711777717117711711777117117711711777717117711711777117117711711777117117711711777017117711711777217117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777171177017117701171177117117777171177117117771171177117117777171177117117771171177117117777
        GameObject clickedObject = eventData.pointerCurrentRaycast.gameObject;

        if (IsClickableObject(clickedObject))
        {
            // 171177117117770171177117117770171177117117770171177117117774MissionManager171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777
            if (missionManager != null)
            {
                missionManager.OnMissionItemClicked(missionIndex);
            }
            else
            {
                Debug.LogWarning("MissionSection: MissionManager17117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777171177017117711171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117779171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777");
            }
        }
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117779171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    private bool IsClickableObject(GameObject clickedObject)
    {
        // 17117711711777017117711711777117117711711777117117711711777717117711711777017117711711777017117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777017117711711777917117711711777117117711711777717117711711777117117711711777717117711711777117117711711777117117711711777017117711711777217117711711777117117711711777717117711711777117117711711777717117711711777117117711711777717117711711777171177017117701171177117117777171177117117771171177117117777171177117117771171177117117777
        if (clickableObjects.Contains(clickedObject))
        {
            return true;
        }

        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771711770171177011711771171177771711771171177711711771171177771711771171177717117711711777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117779171177117117771171177117117777171177117117770171177117117772missionBarImage171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        if (missionBarImage != null)
        {
            Transform clickedTransform = clickedObject.transform;
            while (clickedTransform != null)
            {
                if (clickedTransform.gameObject == missionBarImage.gameObject)
                {
                    return true;
                }
                clickedTransform = clickedTransform.parent;
            }
        }

        return false;
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777MissionManager171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void SetMissionIndex(int index)
    {
        missionIndex = index;
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        UpdateMissionDisplay();
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777MissionManager171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777MissionManager171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void SetMissionManager(MissionManager manager)
    {
        missionManager = manager;
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117775171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        UpdateMissionDisplay();
    }

    // 171177117117770171177117117771171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777MissionManager171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    public void SetConfirmedStateDirectly(bool confirmed)
    {
        isConfirmed = confirmed;
        if (missionBarImage != null)
        {
            missionBarImage.sprite = isConfirmed ? confirmedSprite : normalSprite;
        }

        Debug.Log($"MissionSection {missionIndex}: 171177117117770171177117117778171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772 {(confirmed ? "171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777" : "171177117117771711771711770171177117117772171177117117771171177117117777171177117117771171177117117777")}");
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117770171177117117773171177117117771171177117117773171177117117771171177117117777
    protected virtual void OnMissionConfirmed()
    {
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117778171177117117771171177117117777
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771711770171177611711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177717117711711777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117774171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117770171177117117773171177117117771171177117117773171177117117771171177117117777
    protected virtual void OnMissionUnconfirmed()
    {
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117778171177117117771171177117117777
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771711770171177611711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177717117711711777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117770171177117117770
    public bool IsConfirmed()
    {
        return isConfirmed;
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
    public int GetMissionIndex()
    {
        return missionIndex;
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777Image171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void SetMissionBarImage(Image image)
    {
        missionBarImage = image;
        // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117778171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777
        CollectClickableObjects();
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117779171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void SetNormalSprite(Sprite sprite)
    {
        normalSprite = sprite;
        if (missionBarImage != null && !isConfirmed)
        {
            missionBarImage.sprite = normalSprite;
        }
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void SetConfirmedSprite(Sprite sprite)
    {
        confirmedSprite = sprite;
        if (missionBarImage != null && isConfirmed)
        {
            missionBarImage.sprite = confirmedSprite;
        }
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117776171177117117771171177117117777171177117117770171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771711770171177011711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177701711771171177741711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177717117711711777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void RefreshClickableObjects()
    {
        CollectClickableObjects();
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117773171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void SetMissionNameText(TextMeshProUGUI textComponent)
    {
        missionNameText = textComponent;
        UpdateMissionDisplay();
    }

    // 171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void SetMissionTypeIcon(Image iconComponent)
    {
        missionTypeIcon = iconComponent;
        UpdateMissionDisplay();
    }

    // 1711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177701711771171177761711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177701711771171177751711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177751711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177711711771171177771711771171177717117711711777171177117117770171177117117772171177117117771171177117117777171177117117771171177117117777171177117117771171177117117777171177117117770171177117117770171177117117771171177117117777
    public void RefreshMissionDisplay()
    {
        UpdateMissionDisplay();
    }
}
